#summary task 需求和算法的描述

这个文档属于临时的工程文档。 当task 完成后，相应内容如有有价值，会转移到正式文档中。 
这个文档保持正在进行中的，较为复杂的task 的一些开发所需的信息。 

== eb07 需求 == 

erlbattle 时间节拍处理程序第一步先将当前战场要做的动作都执行完成(eb-06). 完成后会有很多战士处于wait 状态. (注意还有些不处于wait 状态,他们的动作可能在下一节拍,或者更久后才会生效)

eb07 要做的工作,是从battle_field表中取出所有的处于wait 状态的战士,然后去查BlueQueue,RedQueue 这两个表. 这两个表中的信息已经由指令处理的程序维护好了, eb07 假设这两个表都有了信息. 信息格式已经定义了,看schema.erl 中的command 记录.  

如果该战士在其队列中有命令,且该命令的时间小于等于当前节拍, 就把这个命令填到 battle_field 表中, 改  action 和act_effect_time  两个字段。 注意battle_field表中的act_effect_time 字段反映的是生效时间，不是发动时间，因此你要根据各个动作的耗时算一下再填。

然后把queue 里面的记录删掉。  再处理下一个处于wait 状态的战士，直到全部完成。




     