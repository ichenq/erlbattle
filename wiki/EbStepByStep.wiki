#summary 一步步来玩 EB
#labels Phase-Support,FAQ

最快的开始...^假设你已经安装了erl 环境，并且会用svn, 使用M$ 或者 linux 环境^


*ERLANG 环境： 5.7.2  （部分语法老版本不支持，需要用这个版本以上）* 

 * 1. [http://erlbattle.googlecode.com/files/war-2.zip 播放器和战斗录像下载]^内有readme.txt^
 * 2. 观看录像，获得饿狼战役战斗的直观感觉
 * 3. 用svn下载代码到你的机器上。 http://erlbattle.googlecode.com/svn/trunk
 * 4. window 运行 config.bat, linux 运行 config
 * 5. 进入 eb0 目录； windows 用 nmake test   ; linux 用 make test (nmake 下载：http://erlbattle.googlecode.com/files/nmake.exe )
 * ^5.5 或者上面的4和5都不做。直接进入eb0目录，执行make.bat(M$)/make.sh(linux)^
 * 6. 在命令行中输入`erl`进入Erlang shell 环境
 * 7. 启动游戏: `erlbattle:start().`
  * 有3种启动模式:
   # erlbattle:start().   这个是默认启法， 系统默认是【英格兰卫兵】 和【恐惧的农民】 对砍，每拍时间由系统自己测速决定。  适合第一次玩eb 的朋友使用。
   # erlbattle:start(兰队, 红队).   这个是比赛标准启法。启动对应的部队进行比赛，每拍时间由系统自己测速决定。 
    * 例如： `erlbattle:start(englandArmy, englandArmy).`
   # erlbattle:start(兰队, 红队, 毫秒)   这个是让大家人工控制每拍执行速度， 主要用于调试，观察每拍的情况。 
    * 例如： `erlbattle:start(englandArmy, englandArmy,5000).`   每拍5秒。
 * 8. 系统就启动了. 并且在你反应过来之前就结束了。 
 * 9. 这是你观看的第一场战斗，发生在feardFarmers【恐惧的农民】 和englandArmy【英格兰卫兵】 之间的战斗。
 * 10. 把输出的 erlbattle.warlog 文件改名为warfield.txt。 用第一步下载的播放器播放这个战斗
 * 11. 尝试运行 erlbattle:start(englandArmy,englandArmy)  让两个【英格兰卫兵】比赛
 * 12. 把输出的 erlbattle.warlog 文件改名为warfield.txt。 用第一步下载的播放器播放这个战斗
 * 13. 阅读战场程序代码，或者动手编写你的第一个指挥程序。。。。enjoy it. 

 参考::
  * *[EbInterface EB:接口定义]*^玩家指挥程序编写指南^

<br><br><br>

----


=== 好书 ===
*"[http://www.douban.com/subject/3260311/ Erlang程序设计]"* ^(豆瓣)^

<wiki:toc/>

= for R12B(V5.5.5) =

== 快入流程 ==
需要: [http://www.erlang.org/download.html erl-otpR12B-5~下载地址]

# Windows
需要: nmake, 下载地址[http://erlbattle.googlecode.com/files/nmake.exe]
执行下面两个命令
{{{
D:\erlbattle>configure
D:\erlbattle>nmake
}}}
# Linux
需要gnumake
{{{
#./configure
#make
}}}

# 启动erl
{{{
>erl
}}}

# 加载ebin路径
 * .beam文件，也就是erlang代码所编译出来的字节码
 * ebin目录包含了所有这些beam文件
 * 要运行这些文件首先erl需要在知道这些文件在那
 * 可以在erl环境下使用
{{{
1>code:add_pathz("ebin").
}}}
加载我们的代码（.是erlang语句的结束符不能少.

在erl交互环境下输入`code:getpath().`可以看到当前系统所加载的代码目录.

# 启动erlbattle
{{{
2>erlbattle:start().
}}}
战斗结果或保存于warfield.txt

# 观看结果(windows)
{{{
3>os:cmd("copy warfield.txt _fla").
4>os:cmd("_fla\\Index.html").
}}}

== in Linux ==
`推荐使用 Debian 系的有良好软件仓库支持的发行版本`
~ 这里以 ubuntu 8.04 为例进行说明

=== 安装 erl ===

==== apt ====
{{{
$sudo apt-get install erlang
}}}

或是在`新立得`中搜索 erlang 并安装

http://erlbattle.googlecode.com/files/2009-07-18-154413_544x245_scrot.png

 * 输入命令 erl 就进入了 Erlang shell
{{{
~> erl
Erlang (BEAM) emulator version 5.5.5 [source] [async-threads:0] [kernel-poll:false]

Eshell V5.5.5  (abort with ^G)
}}}

`即 R11B`

==== CEAN ====
*[http://cean.process-one.net/doc/ Comprehensive Erlang Archive Network]*
 * Erlang软件收藏库
 * 效仿[http://www.cpan.org/ CPAN] 的又一个规范的友好的可无限扩展的 Erlang 作品发布平台!
 * 跨平台的轻易安装,并通过一致性的命令安装/升级/卸载 软件!
 * 唯一要注意的是CEAN 可能默认的没有安装编译器,那么只要:
{{{
cean:install(compiler).
}}}
当然可以先查看安装了什么软件:
{{{
 cean:installed().
["appmon","asn1","cean","common_test","compiler","cosEvent",
 "cosEventDomain","cosFileTransfer","cosNotification",
 "cosProperty","cosTime","cosTransactions","crypto",
 "debugger","dialyzer","docbuilder","edoc","et","gs","hipe",
 "ibrowse","ic","inets","inviso","jinterface","kernel",
 "megaco","mnesia",
 [...]|...]
}}}


下载: http://cean.process-one.net/downloads

搜索: http://cean.process-one.net/packages/

运行:
{{{
/opt/bin/cean> ./start.sh 
Erlang (BEAM) emulator version 5.6.4 [source] [smp:2] [async-threads:0] [kernel-poll:false]

Eshell V5.6.4  (abort with ^G)
}}}

`即 R12B`

 建议::
  * EB 稳定后,也可发布到 CEAN 中! 这样,安装 EB 就可以简单的
{{{
cean:install(erlbattle).
}}}

==== 编译最新版本 ====
可能有问题::
 根据:[http://magixyu.javaeye.com/blog/268998 Erlang 安装手记 - magixyu？magixyu！]
 * 配置时依然..
{{{
*********************************************************************
**********************  APPLICATIONS DISABLED  **********************
*********************************************************************

odbc           : ODBC library - link check failed

*********************************************************************
*********************************************************************
**********************  APPLICATIONS INFORMATION  *******************
*********************************************************************

wx             : Can not link the wx driver, wx will NOT be useable

*********************************************************************
}}}
 * 强行编译将:
{{{
...
23 problems (5 errors, 18 warnings)
make[4]: *** [/usr/local/tmp/0day/otp_src_R13B01/lib/jinterface/priv/com/ericsson/otp/erlang/OtpErlangExit.class] 错误 1
make[4]:正在离开目录 `/usr/local/tmp/0day/otp_src_R13B01/lib/jinterface/java_src/com/ericsson/otp/erlang'
make[3]: *** [opt] 错误 2
make[3]:正在离开目录 `/usr/local/tmp/0day/otp_src_R13B01/lib/jinterface/java_src'
make[2]: *** [opt] 错误 2
make[2]:正在离开目录 `/usr/local/tmp/0day/otp_src_R13B01/lib/jinterface'
make[1]: *** [opt] 错误 2
make[1]:正在离开目录 `/usr/local/tmp/0day/otp_src_R13B01/lib'
make: *** [fourth_bootstrap_build] 错误 2
}}}

 解决::
  * [ http://argan.javaeye.com/blog/424110 在ubuntu上编译erlang with wx - 阿干的个人博客 - JavaEye技术网站]
  * [http://groups.google.com/group/erlang-china/browse_thread/thread/acd8efea64e35e2 问下UTF-8 编码的erl 文件如何编译和运行 - Erlang China | Google 网上论坛]


=== 安装 svn ===
{{{
$sudo apt-get install subversion
}}}
检查安装的版本
{{{
l> svn --version
svn，版本 1.5.1 (r32289)
   编译于 Oct  6 2008，12:54:52

版权所有 (C) 2000-2008 CollabNet。
Subversion 是开放源代码软件，请参阅 http://subversion.tigris.org/ 站点。
此产品包含由 CollabNet(http://www.Collab.Net/) 开发的软件。

可使用以下的版本库访问模块: 

* ra_neon : 通过 WebDAV 协议使用 neon 访问版本库的模块。
  - 处理“http”方案
  - 处理“https”方案
* ra_svn : 使用 svn 网络协议访问版本库的模块。  - 使用 Cyrus SASL 认证
  - 处理“svn”方案
* ra_local : 访问本地磁盘的版本库模块。
  - 处理“file”方案
}}}



=== 下载代码 ===
{{{
$ svn checkout http://erlbattle.googlecode.com/svn/trunk/ erlbattle-read-only
}}}

=== 运行EB ===
 预测试::
{{{
$ cd /path/to/u/erlbattle-read-only
$ ./configure
$ cd eb0
$ make test
rm -rf .//erlbattle.beam .//battlefield.beam .//tools.beam .//channel.beam .//battleRecorder.beam .//englandArmy.beam .//feardFarmers.beam .//testAll.beam .//testBattleFieldCreate.beam .//testErlBattleTakeAction.beam .//testErlBattleGetTime.beam 
erlc -W +debug_info -o./ erlbattle.erl
erlc -W +debug_info -o./ battlefield.erl
erlc -W +debug_info -o./ tools.erl
erlc -W +debug_info -o./ channel.erl
erlc -W +debug_info -o./ battleRecorder.erl
erlc -W +debug_info -o./ englandArmy.erl
erlc -W +debug_info -o./ feardFarmers.erl
...
}}}


运行游戏!
{{{
$ erl -noshell -s erlbattle start
Battle Begin ....
Army matching into the battle fileds....
don't kill us , we are poor farmers 
Battle Recorder Begin to Run 
don't kill us , we are poor farmers 
don't kill us , we are poor farmers 
...
}}}

==== Linux 中使用虚拟机 ====
`经过测试，发觉eb0 当前只能运行在 R13B01 版本中！如果 在Linux 中无法编译成功的话，只能使用虚拟机进行体验`

 * 正常的下载和安装官方 for M$ 的 [http://erlang.org/download/otp_win32_R13B.exe otp_win32_R13B.exe]
 * 使用默认配置:
http://erlbattle.googlecode.com/files/2009-07-19-211114_385x299_scrot.png

*注意！*
 * 默认安装后， cmd 中无法识别 erl/erlc 等等命令
 * *必须手工在环境变量 path 中追加当前 erlang 的执行程序目录*
http://erlbattle.googlecode.com/files/2009-07-19-213447_1274x602_scrot.png
 * 然后就可以按照前述步骤进行配置/测试了...
http://erlbattle.googlecode.com/files/2009-07-19-214212_659x477_scrot.png
 * 可惜当前 r369 版本的 eb0 无法运行
http://erlbattle.googlecode.com/files/2009-07-19-214548_504x486_scrot.png


== in M$ ==

=== 安装 erl ===

=== 安装 svn ===

=== 下载代码 ===

=== 编译运行 ===